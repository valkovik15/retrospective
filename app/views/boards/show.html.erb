<% content_for :scripts do %>
  <%= javascript_pack_tag 'application' %>
  <%= stylesheet_pack_tag 'application' %>

  <%= javascript_pack_tag 'ready_button_component' %>
  <% if allowed_to?(:invite?, @board, with: API::BoardPolicy) %>
    <%= javascript_pack_tag 'autocomplete' %>
  <% end %>
<% end %>

<div class='box has-text-centered'>
  <div class='level'>

    <div class='level-item has-text-centered'>
      <h1 class='title'>
        <%= @board.title %>
      </h1>
    </div>

    <div class='level-right'>
      <% if !current_user %>
        <%= link_to 'Sign up to Join', new_user_session_path, class: 'button is-large' %>
      <% elsif @board.memberships.exists?(user_id: current_user.id) %>
        <div id='ready-button'></div>
      <% else %>
        <%= link_to 'Join', board_memberships_path(board_slug: @board.slug), method: :post, class: 'button is-large' %>
      <% end %>
    </div>

  </div>
</div>

<div class="box" id='autocomplete'></div>

<% if @previous_action_items %>
  <% column_class_name = 'column is-one-fifth' %>
<% else %>
  <% column_class_name = 'column is-one-quarter' %>
<% end %>

<%= react_component('card_table', {
              actionItems: @action_items,
              board: @board,
              cardsByType: @cards_by_type,
              creators: @board_creators,
              initPrevItems: @previous_action_items || [],
              user: current_user.email
            })
%>

</div>
